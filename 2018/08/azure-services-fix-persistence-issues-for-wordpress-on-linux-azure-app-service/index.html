<!DOCTYPE html>
<html lang="en-US"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><script type="text/javascript">
		document.documentElement.className = 'js';
	</script><script>var et_site_url='https://frankthoughts.github.io';var et_post_id='165';function et_core_page_resource_fallback(a,b){"undefined"===typeof b&&(b=a.sheet.cssRules&&0===a.sheet.cssRules.length);b&&(a.onerror=null,a.onload=null,a.href?a.href=et_site_url+"/?et_core_page_resource="+a.id+et_post_id:a.src&&(a.src=et_site_url+"/?et_core_page_resource="+a.id+et_post_id))}
</script><title>Azure Services – Fix Persistence Issues for WordPress on Linux Azure App Services – FrankThoughts</title><link rel="dns-prefetch" href="//fonts.googleapis.com"><link rel="dns-prefetch" href="//s.w.org"><link rel="stylesheet" id="wp-block-library-css" href="https://frankthoughts.github.io/wp-includes/css/dist/block-library/style.min.css" type="text/css" media="all"><link rel="stylesheet" id="et_monarch-css-css" href="https://frankthoughts.github.io/wp-content/plugins/monarch/css/style.css" type="text/css" media="all"><link rel="stylesheet" id="et-gf-open-sans-css" href="http://fonts.googleapis.com/css?family=Open+Sans:400,700" type="text/css" media="all"><link rel="stylesheet" id="divi-fonts-css" href="http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800&subset=latin,latin-ext" type="text/css" media="all"><link rel="stylesheet" id="divi-style-css" href="https://frankthoughts.github.io/wp-content/themes/Divi/style.css" type="text/css" media="all"><link rel="stylesheet" id="dashicons-css" href="https://frankthoughts.github.io/wp-includes/css/dashicons.min.css" type="text/css" media="all"><script type="text/javascript" src="https://frankthoughts.github.io/wp-includes/js/jquery/jquery.js"></script><script type="text/javascript" src="https://frankthoughts.github.io/wp-includes/js/jquery/jquery-migrate.min.js"></script><script type="text/javascript" src="https://frankthoughts.github.io/wp-content/themes/Divi/core/admin/js/es6-promise.auto.min.js"></script><script type="text/javascript">
/* <![CDATA[ */
var et_core_api_spam_recaptcha = {"site_key":"","page_action":{"action":"azure_services_fix_persistence_issues_for_wordpress_on_linux_azure_app_service"}};
/* ]]> */
</script><script type="text/javascript" src="https://frankthoughts.github.io/wp-content/themes/Divi/core/admin/js/recaptcha.js"></script><style type="text/css" id="et-social-custom-css">
				
			</style><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"><link rel="shortcut icon" href=""><link rel="stylesheet" id="et-divi-customizer-global-cached-inline-styles" href="https://frankthoughts.github.io/wp-content/et-cache/global/et-divi-customizer-global-15906292806701.min.css" onerror="et_core_page_resource_fallback(this, true)" onload="et_core_page_resource_fallback(this)"></head><body class="post-template-default single single-post postid-165 single-format-standard et_bloom et_monarch et_pb_button_helper_class et_fullwidth_nav et_fixed_nav et_show_nav et_hide_primary_logo et_hide_fixed_logo et_primary_nav_dropdown_animation_fade et_secondary_nav_dropdown_animation_fade et_header_style_centered et_pb_footer_columns1 et_cover_background et_pb_gutter et_pb_gutters3 et_right_sidebar et_divi_theme et-db et_minified_js et_minified_css">
	<div id="page-container">

	
	
			<header id="main-header" data-height-onload="66"><div class="container clearfix et_menu_container">
							<div class="logo_container">
					<span class="logo_helper"></span>
					<a href="https://frankthoughts.github.io/">
						<img src="https://frankthoughts.github.io/wp-content/themes/Divi/images/logo.png" alt="FrankThoughts" id="logo" data-height-percentage="54"></a>
				</div>
							<div id="et-top-navigation" data-height="66" data-fixed-height="40">
											<nav id="top-menu-nav"><ul id="top-menu" class="nav"><li id="menu-item-198" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-home menu-item-198"><a href="https://frankthoughts.github.io/">Home</a></li>
<li id="menu-item-216" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-216"><a href="https://frankthoughts.github.io/posts/">Posts</a></li>
<li id="menu-item-199" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-199"><a href="https://frankthoughts.github.io/azure-community-engineer/">About Me</a></li>
<li id="menu-item-200" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-200"><a href="https://frankthoughts.github.io/privacy-policy-2/">Privacy Policy</a></li>
</ul></nav><div id="et_mobile_nav_menu">
				<div class="mobile_nav closed">
					<span class="select_page">Select Page</span>
					<span class="mobile_menu_bar mobile_menu_bar_toggle"></span>
				</div>
			</div>				</div> 
			</div> 
			<div class="et_search_outer">
				<div class="container et_search_form_container">
					<form role="search" method="get" class="et-search-form" action="https://frankthoughts.github.io/">
					<input type="search" class="et-search-field" placeholder="Search …" value="" name="s" title="Search for:"></form>
					<span class="et_close_search_field"></span>
				</div>
			</div>
		</header><div id="et-main-area">
	
<div id="main-content">
		<div class="container">
		<div id="content-area" class="clearfix">
			<div id="left-area">
											<article id="post-165" class="et_pb_post post-165 post type-post status-publish format-standard hentry category-azure-services tag-app-service tag-azure tag-deleted tag-disappeared tag-issues tag-linux tag-lost tag-persistence tag-plugins tag-wordpress"><div class="et_post_meta_wrapper">
							<h1 class="entry-title">Azure Services – Fix Persistence Issues for WordPress on Linux Azure App Services</h1>

						
												</div> 
				
					<div class="entry-content">
					<h1>Introduction</h1>
<p>Every now and then I was having issues with my WordPress on Linux App Service gallery application I had gotten from the Azure Marketplace. My plugins would disappear, my themes would break, and all my pictures would disappear. This article is to help users with issues like this, showing how to fix persistence issues for WordPress on Linux Azure App Services.</p>
<h2>Explanation of Behavior</h2>
<p>The reason that this issue occurs is due to the fact that the files are not persisted on the file system after restarts, moved to another worker, or other web app maintenance that Azure’s master node deems to be suitable for the web app. This makes it so that once there is maintenance on the web app, the cached data isn’t moved over properly. The posts are kept because they are stored on a SQL database (from my understanding).</p>
<h2>Navigating to Kudu</h2>
<p>Before configuring the web app to persist data, first you have to make sure that you backup your current WordPress site. This is because the setting you are going to change is going to wipe the web app and remove all WordPress content.</p>
<blockquote><p>Before backing up your site, make sure that you have all the plugins, etc… installed.</p></blockquote>
<p>In order to backup your current WordPress site, you’ll have to open Kudu on the WordPress application.<br>
Kudu is a sort of dashboard to debug and connect to your app service. For more information on Kudu you can take a look at these links :<br><a href="https://azure.microsoft.com/en-us/resources/videos/what-is-kudu-with-david-ebbo/">Video on Using Kudu From Microsoft</a><br>
That being said, in order to access application’s Kudu please navigate to your app service > advanced tools > go.<br><img src="https://i.imgur.com/Yor6IWP.png"><br>
This will bring you to the Kudu dashboard. From there, go to Debug Console > SSH.<br><img src="https://i.imgur.com/KgZVzJA.png"></p>
<h2>Backing Up Your App Service</h2>
<p>Now that we are in Kudu’s SSH console, we can start backing up the app service’s data. In the SSH Console run the following commands:<br>
[code language=”powershell”]<br>
cd /home/site/wwwroot<br>
apk update<br>
apk add zip<br>
apk add ncftp<br>
zip -r wwwroot.zip .<br>
[/code]<br>
Here we are basically going to the wwwroot for your wordpress site, and zipping up everything on the app service and putting it in the wwwroot directory.<br>
Now that we have created a backup of our WordPress site, we still need to put it into our App Service deployment code. In order to do this, first we will need to get the username, password, and FTP site from the publish profile. To get the publish profile, go to your app service and press “Get Publish Profile” in the Azure portal.<br><img src="https://i.imgur.com/gfNwqMp.png"><br>
Now go back to the SSH console that you got to through Kudu. Now use the code below, replacing YourUsername and YourFTPURL with your respective information retrieved from the Publish Profile :<br>
[code language=”powershell”]<br>
ncftp -u ‘YourUsername\$YourUsername’ <a href="ftp://waws-prod-bay-081.ftp.azurewebsites.windows.net">ftp://YourFTPUrl </a>site<br>
[/code]<br>
Enter your password, and then use the commands :<br>
[code language=”powershell”]<br>
cd site/wwwroot<br>
put wwwroot.zip<br>
[/code]<br>
Now you should have successfully backed up your app service.</p>
<h2>Configuring App Service to Persist</h2>
<blockquote><p>Note: Please make sure that you have backed up your app service properly. If you aren’t sure, please make sure to copy the content on your wordpress blog and back it up. This process is going to wipe your currently deployed app service.</p></blockquote>
<p>Now that we have backed up our app service. We will have to configure our App Service to properly cache your data. In order to do this go to your app service’s app settings and simply configure the websites_enable_app_service_storage from false to true.<br><img src="https://i.imgur.com/bXYT4OK.png"><br>
 <br>
Now that we have configured this to true, save it.</p>
<h2>Restoring Your App Service</h2>
<p>This will now wipe your app service. Now when you go to your website now and it shows a default app service page. This is normal.<br>
Reopen your Kudu SSH console, and unzip the file you zipped in the backup stage into your app service.<br>
[code language=”powershell”]<br>
unzip wwwroot.zip<br>
[/code]<br>
You have now restored the App Service and it will look like it used to.</p>
<h2>Conclusion</h2>
<p>We have gone through connecting to Kudu, backing up your app service, configuring your app service for persistence, and restoring your app service. Now your WordPress should be ready to go and your plugins won’t disappear again. If you have anymore questions feel free to post a comment or to open a support ticket with Azure, one of Microsoft’s Support Engineers will reach out to you to resolve the issue as soon as possible.<br>
[poet-badge]<br>
 </p>
					</div> 
					<div class="et_post_meta_wrapper">
					

<section id="comment-wrap"><div id="comment-section" class="nocomments">
		  			 

		  	   </div>
					<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title"><span>Submit a Comment</span> <small><a rel="nofollow" id="cancel-comment-reply-link" href="/2018/08/azure-services-fix-persistence-issues-for-wordpress-on-linux-azure-app-service/#respond" style="display:none;">Cancel reply</a></small></h3><form action="https://frankthoughts.github.io/wp-comments-post.php" method="post" id="commentform" class="comment-form"><p class="comment-notes"><span id="email-notes">Your email address will not be published.</span> Required fields are marked <span class="required">*</span></p><p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea></p><p class="comment-form-author"><label for="author">Name <span class="required">*</span></label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" required="required"></p>
<p class="comment-form-email"><label for="email">Email <span class="required">*</span></label> <input id="email" name="email" type="text" value="" size="30" maxlength="100" aria-describedby="email-notes" required="required"></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="text" value="" size="30" maxlength="200"></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes"><label for="wp-comment-cookies-consent">Save my name, email, and website in this browser for the next time I comment.</label></p>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit et_pb_button" value="Submit Comment"><input type="hidden" name="comment_post_ID" value="165" id="comment_post_ID"><input type="hidden" name="comment_parent" id="comment_parent" value="0"></p></form>	</div>
		</section></div> 
				</article></div> 

				<div id="sidebar">
		<div id="search-2" class="et_pb_widget widget_search"><form role="search" method="get" id="searchform" class="searchform" action="https://frankthoughts.github.io/">
				<div>
					<label class="screen-reader-text" for="s">Search for:</label>
					<input type="text" value="" name="s" id="s"><input type="submit" id="searchsubmit" value="Search"></div>
			</form></div> 		<div id="recent-posts-2" class="et_pb_widget widget_recent_entries">		<h4 class="widgettitle">Recent Posts</h4>		<ul><li>
					<a href="https://frankthoughts.github.io/2018/08/3d-printing-how-to-3d-model-threads-for-screws-using-freecad-threaded-base/">3D Printing – How to 3D Model Threads for Screws Using FreeCAD</a>
									</li>
											<li>
					<a href="https://frankthoughts.github.io/2018/08/azure-services-fix-persistence-issues-for-wordpress-on-linux-azure-app-service/" aria-current="page">Azure Services – Fix Persistence Issues for WordPress on Linux Azure App Services</a>
									</li>
											<li>
					<a href="https://frankthoughts.github.io/2018/08/alternative-food-reviews-soylent-after-a-month-straight/">Alternative Food Reviews – Soylent After a Month Straight</a>
									</li>
											<li>
					<a href="https://frankthoughts.github.io/2018/06/using-frost-po-et-plugin/">Cryptoassets – A Guide On How to Use the Frost Po.et Plugin</a>
									</li>
											<li>
					<a href="https://frankthoughts.github.io/2018/06/azure-active-directory-giving-permissions-for-a-specific-user/">Azure Active Directory – How to Give Permissions for a specific user in Azure Active Directory</a>
									</li>
					</ul></div> <div id="recent-comments-2" class="et_pb_widget widget_recent_comments"><h4 class="widgettitle">Recent Comments</h4><ul id="recentcomments"><li class="recentcomments"><span class="comment-author-link">Rupert Karstens</span> on <a href="https://frankthoughts.github.io/2018/06/plantronics-voyager-focus-uc-review/#comment-21">Office Headphone Review – Plantronics Voyager Focus UC Review</a></li><li class="recentcomments"><span class="comment-author-link">Marina Polin</span> on <a href="https://frankthoughts.github.io/2018/06/plantronics-voyager-focus-uc-review/#comment-20">Office Headphone Review – Plantronics Voyager Focus UC Review</a></li><li class="recentcomments"><span class="comment-author-link">Mildred Hoskey</span> on <a href="https://frankthoughts.github.io/2018/06/plantronics-voyager-focus-uc-review/#comment-19">Office Headphone Review – Plantronics Voyager Focus UC Review</a></li></ul></div> 	</div> 
		</div> 
	</div> 
	</div> 


			<footer id="main-footer"><div id="footer-bottom">
					<div class="container clearfix">
									</div>	
				</div>
			</footer></div> 


	</div> 

	<script type="text/javascript" src="https://frankthoughts.github.io/wp-content/plugins/monarch/js/idle-timer.min.js"></script><script type="text/javascript">
/* <![CDATA[ */
var monarchSettings = {"ajaxurl":"https:\/\/frankthoughts.github.io\/wp-admin\/admin-ajax.php","pageurl":"https:\/\/frankthoughts.github.io\/2018\/08\/azure-services-fix-persistence-issues-for-wordpress-on-linux-azure-app-service\/","stats_nonce":"cb46e2aaf0","share_counts":"ed10b38145","follow_counts":"23040b5028","total_counts":"c6165143dc","media_single":"2c00be7897","media_total":"0f783f45de","generate_all_window_nonce":"ecf808c932","no_img_message":"No images available for sharing on this page"};
/* ]]> */
</script><script type="text/javascript" src="https://frankthoughts.github.io/wp-content/plugins/monarch/js/custom.js"></script><script type="text/javascript">
/* <![CDATA[ */
var DIVI = {"item_count":"%d Item","items_count":"%d Items"};
var et_shortcodes_strings = {"previous":"Previous","next":"Next"};
var et_pb_custom = {"ajaxurl":"https:\/\/frankthoughts.github.io\/wp-admin\/admin-ajax.php","images_uri":"https:\/\/frankthoughts.github.io\/wp-content\/themes\/Divi\/images","builder_images_uri":"https:\/\/frankthoughts.github.io\/wp-content\/themes\/Divi\/includes\/builder\/images","et_frontend_nonce":"ecfccd278f","subscription_failed":"Please, check the fields below to make sure you entered the correct information.","et_ab_log_nonce":"2741cea3ab","fill_message":"Please, fill in the following fields:","contact_error_message":"Please, fix the following errors:","invalid":"Invalid email","captcha":"Captcha","prev":"Prev","previous":"Previous","next":"Next","wrong_captcha":"You entered the wrong number in captcha.","wrong_checkbox":"Checkbox","ignore_waypoints":"no","is_divi_theme_used":"1","widget_search_selector":".widget_search","ab_tests":[],"is_ab_testing_active":"","page_id":"165","unique_test_id":"","ab_bounce_rate":"5","is_cache_plugin_active":"no","is_shortcode_tracking":"","tinymce_uri":""}; var et_frontend_scripts = {"builderCssContainerPrefix":"#et-boc","builderCssLayoutPrefix":"#et-boc .et-l"};
var et_pb_box_shadow_elements = [];
var et_pb_motion_elements = {"desktop":[],"tablet":[],"phone":[]};
/* ]]> */
</script><script type="text/javascript" src="https://frankthoughts.github.io/wp-content/themes/Divi/js/custom.unified.js"></script><script type="text/javascript" src="https://frankthoughts.github.io/wp-content/themes/Divi/core/admin/js/common.js"></script></body></html>
