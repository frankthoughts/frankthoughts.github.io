<!DOCTYPE html>
<html lang="en-US"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><script type="text/javascript">
		document.documentElement.className = 'js';
	</script><script>var et_site_url='https://frankthoughts.github.io';var et_post_id='100';function et_core_page_resource_fallback(a,b){"undefined"===typeof b&&(b=a.sheet.cssRules&&0===a.sheet.cssRules.length);b&&(a.onerror=null,a.onload=null,a.href?a.href=et_site_url+"/?et_core_page_resource="+a.id+et_post_id:a.src&&(a.src=et_site_url+"/?et_core_page_resource="+a.id+et_post_id))}
</script><title>Azure Active Directory – How to Give Permissions for a specific user in Azure Active Directory – FrankThoughts</title><link rel="dns-prefetch" href="//fonts.googleapis.com"><link rel="dns-prefetch" href="//s.w.org"><link rel="stylesheet" id="wp-block-library-css" href="https://frankthoughts.github.io/wp-includes/css/dist/block-library/style.min.css" type="text/css" media="all"><link rel="stylesheet" id="et_monarch-css-css" href="https://frankthoughts.github.io/wp-content/plugins/monarch/css/style.css" type="text/css" media="all"><link rel="stylesheet" id="et-gf-open-sans-css" href="http://fonts.googleapis.com/css?family=Open+Sans:400,700" type="text/css" media="all"><link rel="stylesheet" id="divi-fonts-css" href="http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800&subset=latin,latin-ext" type="text/css" media="all"><link rel="stylesheet" id="divi-style-css" href="https://frankthoughts.github.io/wp-content/themes/Divi/style.css" type="text/css" media="all"><link rel="stylesheet" id="dashicons-css" href="https://frankthoughts.github.io/wp-includes/css/dashicons.min.css" type="text/css" media="all"><script type="text/javascript" src="https://frankthoughts.github.io/wp-includes/js/jquery/jquery.js"></script><script type="text/javascript" src="https://frankthoughts.github.io/wp-includes/js/jquery/jquery-migrate.min.js"></script><script type="text/javascript" src="https://frankthoughts.github.io/wp-content/themes/Divi/core/admin/js/es6-promise.auto.min.js"></script><script type="text/javascript">
/* <![CDATA[ */
var et_core_api_spam_recaptcha = {"site_key":"","page_action":{"action":"azure_active_directory_giving_permissions_for_a_specific_user"}};
/* ]]> */
</script><script type="text/javascript" src="https://frankthoughts.github.io/wp-content/themes/Divi/core/admin/js/recaptcha.js"></script><style type="text/css" id="et-social-custom-css">
				
			</style><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"><link rel="shortcut icon" href=""><link rel="stylesheet" id="et-divi-customizer-global-cached-inline-styles" href="https://frankthoughts.github.io/wp-content/et-cache/global/et-divi-customizer-global-15906292806701.min.css" onerror="et_core_page_resource_fallback(this, true)" onload="et_core_page_resource_fallback(this)"></head><body class="post-template-default single single-post postid-100 single-format-standard et_bloom et_monarch et_pb_button_helper_class et_fullwidth_nav et_fixed_nav et_show_nav et_hide_primary_logo et_hide_fixed_logo et_primary_nav_dropdown_animation_fade et_secondary_nav_dropdown_animation_fade et_header_style_centered et_pb_footer_columns1 et_cover_background et_pb_gutter et_pb_gutters3 et_right_sidebar et_divi_theme et-db et_minified_js et_minified_css">
	<div id="page-container">

	
	
			<header id="main-header" data-height-onload="66"><div class="container clearfix et_menu_container">
							<div class="logo_container">
					<span class="logo_helper"></span>
					<a href="https://frankthoughts.github.io/">
						<img src="https://frankthoughts.github.io/wp-content/themes/Divi/images/logo.png" alt="FrankThoughts" id="logo" data-height-percentage="54"></a>
				</div>
							<div id="et-top-navigation" data-height="66" data-fixed-height="40">
											<nav id="top-menu-nav"><ul id="top-menu" class="nav"><li id="menu-item-198" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-home menu-item-198"><a href="https://frankthoughts.github.io/">Home</a></li>
<li id="menu-item-216" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-216"><a href="https://frankthoughts.github.io/posts/">Posts</a></li>
<li id="menu-item-199" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-199"><a href="https://frankthoughts.github.io/azure-community-engineer/">About Me</a></li>
<li id="menu-item-200" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-200"><a href="https://frankthoughts.github.io/privacy-policy-2/">Privacy Policy</a></li>
</ul></nav><div id="et_mobile_nav_menu">
				<div class="mobile_nav closed">
					<span class="select_page">Select Page</span>
					<span class="mobile_menu_bar mobile_menu_bar_toggle"></span>
				</div>
			</div>				</div> 
			</div> 
			<div class="et_search_outer">
				<div class="container et_search_form_container">
					<form role="search" method="get" class="et-search-form" action="https://frankthoughts.github.io/">
					<input type="search" class="et-search-field" placeholder="Search …" value="" name="s" title="Search for:"></form>
					<span class="et_close_search_field"></span>
				</div>
			</div>
		</header><div id="et-main-area">
	
<div id="main-content">
		<div class="container">
		<div id="content-area" class="clearfix">
			<div id="left-area">
											<article id="post-100" class="et_pb_post post-100 post type-post status-publish format-standard hentry category-cloud-identity tag-aad tag-azure-active-directory tag-enterprise-application tag-one tag-permissions tag-service-principal tag-single tag-specific tag-user"><div class="et_post_meta_wrapper">
							<h1 class="entry-title">Azure Active Directory – How to Give Permissions for a specific user in Azure Active Directory</h1>

						
												</div> 
				
					<div class="entry-content">
					<h1>Introduction</h1>
<p>This post is to help to teach How to Give Permissions for a specific user in Azure Active Directory. This post will assume that your API is already set up properly and you have Global Admin rights to grant the permissions to a specific user. If you are not a global admin for the tenant, you will receive a 400 error saying that you are not authorized to do this. For more information on setting up to utilize the Microsoft Graph API or AAD Graph API please refer to this article: <a href="https://blogs.msdn.microsoft.com/aaddevsup/2018/05/23/using-postman-to-call-the-microsoft-graph-api-using-authorization-code-flow/">https://blogs.msdn.microsoft.com/aaddevsup/2018/05/23/using-postman-to-call-the-microsoft-graph-api-using-authorization-code-flow/</a></p>
<h1>Granting Permissions to a Specific User</h1>
<p>When trying to grant a permission to an individual user you will have to grant a specific OAuth2permisison in the tenant for the user. You can do this by using the OAuth2PermissionGrants endpoint.<br>
The only option right now is to utilize the Azure Active Directory(AAD) Graph API endpoint as the Microsoft Graph API doesn’t support this feature yet.<br>
First, you will want to create an AAD Application Registration, and to press the grant permissions for the Application Registration. This will create an enterprise application for your AAD Application Registration which you will need later.<br>
Using the AAD Graph API, you will want to make a post request to <em>https://graph.windows.net/$tenant/oauth2PermissionGrants?API-version=1.6</em><br>
Replacing <em>$tenant</em> with your tenant ID.<br>
In the request body, you will need to describe the properties for your new Oauth2PermissionGrant. I’ve described what you will need in your body below.</p>
<pre>{
"clientId": "This is the objectID of the enterprise application/service principal of the AAD Application Registration. You can find this by going to your enterprise Applications blade and finding the enterprise application you created earlier. The object ID should be there.",
"consentType": "please refer to principalID attribute below for more information on the consent type; we will want to put Principal here to grant permissions to a single user",
"expiryTime": "2027-10-08T19:26:10.0101209 (Insert your expiration time here)",
"principalId": "If consentType is "AllPrincipals", the principal ID value should be null, and this consent will apply to all users in the organization.
If consentType is "Principal" then this property specifies the objectId of the user that granted consent, and applies only to that user.",
"resourceId": " bd8e522d-efb5-447e-a2aa-6f500446f2e1, place the resource ID of the resource you want your user to have access to, here I have placed an o365 exchange online object ID ",
"scope": "(insert your scopes/permissions for the user here)",
"startTime": "0001-01-01T00:00:00"
}
</pre>
<p>For more information on the entity: OAuth2Permission Grant please refer to our documentation here: <a href="https://msdn.microsoft.com/en-us/library/azure/ad/graph/api/entity-and-complex-type-reference#oauth2permissiongrant-entity">https://msdn.microsoft.com/en-us/library/azure/ad/graph/api/entity-and-complex-type-reference#oauth2permissiongrant-entity</a><br>
The scopes you can use are listed below.<br>
Delegated (work or school account) Directory.ReadWrite.All, Directory.AccessAsUser.All<br>
Delegated (personal Microsoft account) Not supported.<br>
Application Directory.ReadWrite.All</p>
<h1>Conclusion</h1>
<p>By using the Azure Active Directory Graph API and sending a Post Request to the OAuth2PermissionGrant endpoint we are able to give a single user the proper scopes to access a secured API. I refer to another blog using Postman to get an access token utilizing the Authorization Code Flow in order to access the Microsoft Graph API. Note that the same process to get an access token for the Microsoft Graph API will be used to get an access to the AAD Graph API. The only difference will be to grant the proper permissions to the AAD Graph API instead of the Microsoft Graph API and to set a different resource when requesting the access token. After getting access to the AAD Graph API we construct the Post request to the oauth2permissions grant endpoint in the AAD Graph API creating the service principal for the AAD User so that they can access a secured API based on the object ID of the user using a service principal in AAD.<br>
[poet-badge]</p>
					</div> 
					<div class="et_post_meta_wrapper">
					

<section id="comment-wrap"><div id="comment-section" class="nocomments">
		  			 

		  	   </div>
					<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title"><span>Submit a Comment</span> <small><a rel="nofollow" id="cancel-comment-reply-link" href="/2018/06/azure-active-directory-giving-permissions-for-a-specific-user/#respond" style="display:none;">Cancel reply</a></small></h3><form action="https://frankthoughts.github.io/wp-comments-post.php" method="post" id="commentform" class="comment-form"><p class="comment-notes"><span id="email-notes">Your email address will not be published.</span> Required fields are marked <span class="required">*</span></p><p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea></p><p class="comment-form-author"><label for="author">Name <span class="required">*</span></label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" required="required"></p>
<p class="comment-form-email"><label for="email">Email <span class="required">*</span></label> <input id="email" name="email" type="text" value="" size="30" maxlength="100" aria-describedby="email-notes" required="required"></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="text" value="" size="30" maxlength="200"></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes"><label for="wp-comment-cookies-consent">Save my name, email, and website in this browser for the next time I comment.</label></p>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit et_pb_button" value="Submit Comment"><input type="hidden" name="comment_post_ID" value="100" id="comment_post_ID"><input type="hidden" name="comment_parent" id="comment_parent" value="0"></p></form>	</div>
		</section></div> 
				</article></div> 

				<div id="sidebar">
		<div id="search-2" class="et_pb_widget widget_search"><form role="search" method="get" id="searchform" class="searchform" action="https://frankthoughts.github.io/">
				<div>
					<label class="screen-reader-text" for="s">Search for:</label>
					<input type="text" value="" name="s" id="s"><input type="submit" id="searchsubmit" value="Search"></div>
			</form></div> 		<div id="recent-posts-2" class="et_pb_widget widget_recent_entries">		<h4 class="widgettitle">Recent Posts</h4>		<ul><li>
					<a href="https://frankthoughts.github.io/2018/08/3d-printing-how-to-3d-model-threads-for-screws-using-freecad-threaded-base/">3D Printing – How to 3D Model Threads for Screws Using FreeCAD</a>
									</li>
											<li>
					<a href="https://frankthoughts.github.io/2018/08/azure-services-fix-persistence-issues-for-wordpress-on-linux-azure-app-service/">Azure Services – Fix Persistence Issues for WordPress on Linux Azure App Services</a>
									</li>
											<li>
					<a href="https://frankthoughts.github.io/2018/08/alternative-food-reviews-soylent-after-a-month-straight/">Alternative Food Reviews – Soylent After a Month Straight</a>
									</li>
											<li>
					<a href="https://frankthoughts.github.io/2018/06/using-frost-po-et-plugin/">Cryptoassets – A Guide On How to Use the Frost Po.et Plugin</a>
									</li>
											<li>
					<a href="https://frankthoughts.github.io/2018/06/azure-active-directory-giving-permissions-for-a-specific-user/" aria-current="page">Azure Active Directory – How to Give Permissions for a specific user in Azure Active Directory</a>
									</li>
					</ul></div> <div id="recent-comments-2" class="et_pb_widget widget_recent_comments"><h4 class="widgettitle">Recent Comments</h4><ul id="recentcomments"><li class="recentcomments"><span class="comment-author-link">Rupert Karstens</span> on <a href="https://frankthoughts.github.io/2018/06/plantronics-voyager-focus-uc-review/#comment-21">Office Headphone Review – Plantronics Voyager Focus UC Review</a></li><li class="recentcomments"><span class="comment-author-link">Marina Polin</span> on <a href="https://frankthoughts.github.io/2018/06/plantronics-voyager-focus-uc-review/#comment-20">Office Headphone Review – Plantronics Voyager Focus UC Review</a></li><li class="recentcomments"><span class="comment-author-link">Mildred Hoskey</span> on <a href="https://frankthoughts.github.io/2018/06/plantronics-voyager-focus-uc-review/#comment-19">Office Headphone Review – Plantronics Voyager Focus UC Review</a></li></ul></div> 	</div> 
		</div> 
	</div> 
	</div> 


			<footer id="main-footer"><div id="footer-bottom">
					<div class="container clearfix">
									</div>	
				</div>
			</footer></div> 


	</div> 

	<script type="text/javascript" src="https://frankthoughts.github.io/wp-content/plugins/monarch/js/idle-timer.min.js"></script><script type="text/javascript">
/* <![CDATA[ */
var monarchSettings = {"ajaxurl":"https:\/\/frankthoughts.github.io\/wp-admin\/admin-ajax.php","pageurl":"https:\/\/frankthoughts.github.io\/2018\/06\/azure-active-directory-giving-permissions-for-a-specific-user\/","stats_nonce":"cb46e2aaf0","share_counts":"ed10b38145","follow_counts":"23040b5028","total_counts":"c6165143dc","media_single":"2c00be7897","media_total":"0f783f45de","generate_all_window_nonce":"ecf808c932","no_img_message":"No images available for sharing on this page"};
/* ]]> */
</script><script type="text/javascript" src="https://frankthoughts.github.io/wp-content/plugins/monarch/js/custom.js"></script><script type="text/javascript">
/* <![CDATA[ */
var DIVI = {"item_count":"%d Item","items_count":"%d Items"};
var et_shortcodes_strings = {"previous":"Previous","next":"Next"};
var et_pb_custom = {"ajaxurl":"https:\/\/frankthoughts.github.io\/wp-admin\/admin-ajax.php","images_uri":"https:\/\/frankthoughts.github.io\/wp-content\/themes\/Divi\/images","builder_images_uri":"https:\/\/frankthoughts.github.io\/wp-content\/themes\/Divi\/includes\/builder\/images","et_frontend_nonce":"ecfccd278f","subscription_failed":"Please, check the fields below to make sure you entered the correct information.","et_ab_log_nonce":"2741cea3ab","fill_message":"Please, fill in the following fields:","contact_error_message":"Please, fix the following errors:","invalid":"Invalid email","captcha":"Captcha","prev":"Prev","previous":"Previous","next":"Next","wrong_captcha":"You entered the wrong number in captcha.","wrong_checkbox":"Checkbox","ignore_waypoints":"no","is_divi_theme_used":"1","widget_search_selector":".widget_search","ab_tests":[],"is_ab_testing_active":"","page_id":"100","unique_test_id":"","ab_bounce_rate":"5","is_cache_plugin_active":"no","is_shortcode_tracking":"","tinymce_uri":""}; var et_frontend_scripts = {"builderCssContainerPrefix":"#et-boc","builderCssLayoutPrefix":"#et-boc .et-l"};
var et_pb_box_shadow_elements = [];
var et_pb_motion_elements = {"desktop":[],"tablet":[],"phone":[]};
/* ]]> */
</script><script type="text/javascript" src="https://frankthoughts.github.io/wp-content/themes/Divi/js/custom.unified.js"></script><script type="text/javascript" src="https://frankthoughts.github.io/wp-content/themes/Divi/core/admin/js/common.js"></script></body></html>
